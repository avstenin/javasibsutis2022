# Основы разработки ПО при помощи Java

## Весенний семестр. 2021-2022 гг.

Ковалев Максим Игоревич, гр. ИВ-923.

## Лабораторная работа №4. Методология ООП

В результате лабораторной работы построен **интерфейс взаимодействия пользователя с данными по тарифам мобильных операторов в Новосибирске**.

## Структура

* [Сборка/использование](#сборкаиспользование)
* [Запуск](#запуск)
  * [Аргументы](#аргументы)
* [Структура программы](#структура-программы)

## Сборка/использование

Для компиляции проекта необходим **[Gradle](https://gradle.org/)** не менее версии 7.

Запустите из данной директории:
```bash
$ gradle clean build
```

Тесты (а находятся они [здесь](../../test/kovalev)) будут проведены автоматически.

Для сборки полного JAR со всеми зависимостями:
```bash
$ gradle uberJar
```

По умолчанию полный архив находится по пути `./build/libs`.

Данные по тарифам хранятся на диске в формате YAML [тут](./assets/telecom/assets); при компиляции они автоматом переносятся в директорию с бинарником.

## Запуск

Два варианта запуска приложения после компиляции:
```bash
(1)  $ gradle run --args="{аргументы}"
(2)  $ java -jar ./build/libs/kovalev-uber.jar {аргументы}
```

### Аргументы

По умолчанию приложения выводит все тарифы мобильной связи, отсортированные по стоимости в месяц. Через аргументы CLI этот список можно отфильтровать:
```bash
usage: Telecom-CLI
    -clb,--calls-min <arg>   Минимальное число бесплатных звонков в тарифе
    -ilb,--inet-min <arg>    Минимальная квота интернета (в ГБ) в тарифе
    -op,--operators <arg>    Фильтр операторов; например, "(МТС;Тинькофф Мобайл)"
    -plb,--price-min <arg>   Минимальная ежемесячная стоимость тарифа
    -pub,--price-max <arg>   Максимальная ежемесячная стоимость тарифа
    -slb,--sms-min <arg>     Минимальное число бесплатных СМС в тарифе
```

## Структура программы

<table>
  <tr>
    <th><code>telecom.CLI</code></th>
    <td>Входной пункт в программу. Проводит парсинг аргументов CLI (используя стороннюю библиотеку <b>Apache Commons CLI</b>) и выводит в консоль отфильтрованный (через класс <code>telecom.FilterCtl</code>) список тарифов.</td>
  </tr>
  <tr>
    <th><code>telecom.FilterCtl</code></th>
    <td>При инициализации извлекает всю информацию о тарифах, используя передаваемый в начале экземпляр класса <code>telecom.YAMLReader</code>. Предоставляет интерфейс сеттеров, чтобы регулировать фильтры (например, минимальную квоту интернета, границы стоимости тарифа, список операторов). По умолчанию фильтры не применяются (параметры находятся по оба края <code>Infinity</code>).<hr>
    Чтобы извлечь отфильтрованный список тарифов, используется метод <code>get()</code> с необязательным параметром компаратора (по умолчанию сортировка происходит по стоимости тарифа).</td>
  </tr>
  <tr>
    <th><code>telecom.YAMLReader</code></th>
    <td>Рекурсивно читает все файлы <code>.yaml</code> в каталоге <code>assets</code>, используя стороннюю библиотеку <b>Jackson</b>.<hr>
    Изначально информация из YAML представляется датаклассами <code>telecom.YAMLOperator</code>.</td>
  </tr>
  <tr>
    <th><code>telecom.YAMLOperator</code></th>
    <td>Датакласс, содержащий в себе поле с именем оператора и вложенный список с его тарифами <code>telecom.YAMLTariff</code>. Используя метод <code>toTariffs</code>, он преобразовывается в массив из независимых элементов <code>telecom.Tariff</code>.</td>
  </tr>
  <tr>
    <th><code>telecom.Tariff</code></th>
    <td>Датакласс, используемый внутри программы. Состоит из полей <i>имени оператора</i>, <i>стоимости</i>, <i>квоты интернета</i>, <i>звонков</i> и <i>СМС</i>. Имеет определённые геттеры/сеттеры, представление в виде строки.</td>
  </tr>
</table>